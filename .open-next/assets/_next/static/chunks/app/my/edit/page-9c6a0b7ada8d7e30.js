(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[204],{3073:function(e,t,r){Promise.resolve().then(r.bind(r,4586))},4586:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return c}});var a=r(7437),o=r(2265),i=r(605),n=r(9376),l=r(5922),s=r(1690),d=r(2196),m=r(9460);function c(){let{data:e,update:t}=(0,i.useSession)(),r=(null==e?void 0:e.user)||null,{theme:c}=(0,l.F)(),f=(0,n.useRouter)(),[g,u]=(0,o.useState)(!1),[p,b]=(0,o.useState)(null),[h,x]=(0,o.useState)(""),[y,v]=(0,o.useState)(""),[S,j]=(0,o.useState)(""),[k,_]=(0,o.useState)(void 0),[w,z]=(0,o.useState)(!1);(0,o.useEffect)(()=>u(!0),[]),(0,o.useEffect)(()=>{if(!(null==r?void 0:r.email))return;let e=localStorage.getItem("dori_profile_".concat(r.email)),t=localStorage.getItem("dori_user_name_".concat(r.email)),a=localStorage.getItem("dori_user_bio_".concat(r.email)),o=localStorage.getItem("dori_status_".concat(r.email)),i=localStorage.getItem("dori_image_".concat(r.email)),n=t||r.name||"사용자",l=a||"",s=o||"",d=i||void 0;if(e)try{let t=JSON.parse(e);b(t),x(t.nickname||n),v(t.bio||l),j(t.statusMessage||s),_(t.profileImageUrl||d)}catch(e){b((0,m.createDefaultProfile)(r.email,r.email,n)),x(n),v(l),j(s),_(d)}else b((0,m.createDefaultProfile)(r.email,r.email,n)),x(n),v(l),j(s),_(d)},[null==r?void 0:r.email,null==r?void 0:r.name]);let I=async()=>{if((null==r?void 0:r.email)&&p){if(!h.trim()){alert("닉네임을 입력해주세요.");return}if(y.length>80){alert("한 줄 소개는 80자 이하여야 합니다.");return}if(S.length>20){alert("상태 메시지는 20자 이하여야 합니다.");return}z(!0);try{let e=await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({nickname:h.trim(),bio:y.trim(),statusMessage:S.trim(),profileImageUrl:k})});if(!e.ok){let t=await e.json();throw Error(t.error||"프로필 업데이트 실패")}let a={...p,nickname:h.trim(),bio:y.trim(),statusMessage:S.trim(),profileImageUrl:k};localStorage.setItem("dori_profile_".concat(r.email),JSON.stringify(a)),localStorage.setItem("dori_user_name_".concat(r.email),h.trim()),localStorage.setItem("dori_user_bio_".concat(r.email),y.trim()),localStorage.setItem("dori_status_".concat(r.email),S.trim()),k&&(localStorage.setItem("dori_image_".concat(r.email),k),window.dispatchEvent(new CustomEvent("profileImageUpdated",{detail:{imageUrl:k,email:r.email}}))),window.dispatchEvent(new CustomEvent("profileUpdated"));let o=JSON.parse(localStorage.getItem("dori_posts")||"[]").map(e=>((e.author===p.nickname||e.nickname===p.nickname||e.author===(null==r?void 0:r.name))&&(e.author=h.trim(),e.nickname=h.trim()),e.commentsList&&(e.commentsList=e.commentsList.map(e=>((e.author===p.nickname||e.author===(null==r?void 0:r.name))&&(e.author=h.trim()),e))),e));localStorage.setItem("dori_posts",JSON.stringify(o)),await t({name:h.trim()}),f.refresh(),z(!1),alert("프로필이 저장되었습니다."),f.push("/my")}catch(e){console.error("프로필 저장 오류:",e),z(!1),alert(e instanceof Error?e.message:"프로필 저장 중 오류가 발생했습니다.")}}},T=g&&"dark"===c;return g&&r?p?(0,a.jsxs)("main",{style:{backgroundColor:T?"#000000":"#ffffff",fontFamily:'"Pretendard", -apple-system, BlinkMacSystemFont, system-ui, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "맑은 고딕", sans-serif',minHeight:"100vh",paddingTop:"70px",overflowY:"auto",position:"relative"},children:[(0,a.jsx)(s.default,{}),T&&(0,a.jsxs)("div",{className:"fixed inset-0 -z-10 pointer-events-none overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute top-0 left-[20%] w-[500px] h-[500px] rounded-full blur-[100px] opacity-40 bg-blue-900 mix-blend-screen animate-pulse"}),(0,a.jsx)("div",{className:"absolute top-[100px] right-[20%] w-[450px] h-[450px] rounded-full blur-[100px] opacity-40 bg-purple-900 mix-blend-screen animate-pulse",style:{animationDelay:"1s"}})]}),(0,a.jsx)("section",{className:"relative z-10",style:{maxWidth:"800px",margin:"0 auto",padding:"4rem 1.5rem 6rem 1.5rem",minHeight:"calc(100vh - 70px)"},children:(0,a.jsxs)("div",{style:{background:T?"rgba(255, 255, 255, 0.02)":"#ffffff",border:"1px solid ".concat(T?"rgba(255, 255, 255, 0.1)":"#e5e5e7"),borderRadius:"1.5rem",padding:"3rem 2rem",boxShadow:T?"0 4px 20px rgba(0, 0, 0, 0.5)":"0 4px 20px rgba(0, 0, 0, 0.05)"},children:[(0,a.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"800",color:T?"#ffffff":"#1d1d1f",marginBottom:"2rem"},children:"프로필 수정"}),(0,a.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"0.9375rem",fontWeight:"600",color:T?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.7)",marginBottom:"1rem"},children:"프로필 이미지"}),(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,a.jsx)(d.Z,{currentImageUrl:k,onImageChange:e=>{_(e),(null==r?void 0:r.email)&&window.dispatchEvent(new CustomEvent("profileImageUpdated",{detail:{imageUrl:e,email:r.email}}))}})})]}),(0,a.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"0.9375rem",fontWeight:"600",color:T?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.7)",marginBottom:"0.5rem"},children:"닉네임 *"}),(0,a.jsx)("input",{type:"text",value:h,onChange:e=>x(e.target.value),placeholder:"닉네임을 입력하세요",maxLength:20,style:{width:"100%",padding:"0.875rem 1rem",borderRadius:"0.75rem",background:T?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.03)",border:"1px solid ".concat(T?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"),color:T?"#ffffff":"#1d1d1f",fontSize:"1rem",fontFamily:"inherit",outline:"none"}})]}),(0,a.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"0.9375rem",fontWeight:"600",color:T?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.7)",marginBottom:"0.5rem"},children:"한 줄 소개 (최대 80자)"}),(0,a.jsx)("textarea",{value:y,onChange:e=>v(e.target.value),placeholder:"자신을 소개하는 한 줄을 입력하세요",maxLength:80,rows:3,style:{width:"100%",padding:"0.875rem 1rem",borderRadius:"0.75rem",background:T?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.03)",border:"1px solid ".concat(T?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"),color:T?"#ffffff":"#1d1d1f",fontSize:"1rem",fontFamily:"inherit",resize:"vertical",outline:"none"}}),(0,a.jsxs)("div",{style:{fontSize:"0.8125rem",color:T?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.5)",marginTop:"0.5rem",textAlign:"right"},children:[y.length,"/80"]})]}),(0,a.jsxs)("div",{style:{marginBottom:"2rem"},children:[(0,a.jsx)("label",{style:{display:"block",fontSize:"0.9375rem",fontWeight:"600",color:T?"rgba(255, 255, 255, 0.8)":"rgba(0, 0, 0, 0.7)",marginBottom:"0.5rem"},children:"상태 메시지 (최대 20자)"}),(0,a.jsx)("input",{type:"text",value:S,onChange:e=>j(e.target.value),placeholder:"예: AI 실무 적용 중",maxLength:20,style:{width:"100%",padding:"0.875rem 1rem",borderRadius:"0.75rem",background:T?"rgba(255, 255, 255, 0.05)":"rgba(0, 0, 0, 0.03)",border:"1px solid ".concat(T?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"),color:T?"#ffffff":"#1d1d1f",fontSize:"1rem",fontFamily:"inherit",outline:"none"}}),(0,a.jsxs)("div",{style:{fontSize:"0.8125rem",color:T?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.5)",marginTop:"0.5rem",textAlign:"right"},children:[S.length,"/20"]})]}),(0,a.jsxs)("div",{style:{padding:"1.5rem",borderRadius:"0.75rem",background:T?"rgba(255, 255, 255, 0.03)":"rgba(0, 0, 0, 0.02)",border:"1px solid ".concat(T?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.08)"),marginBottom:"2rem"},children:[(0,a.jsx)("h3",{style:{fontSize:"0.9375rem",fontWeight:"600",color:T?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.5)",marginBottom:"1rem"},children:"수정 불가 항목"}),(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:"0.8125rem",color:T?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.5)",marginBottom:"0.25rem"},children:"이메일"}),(0,a.jsx)("div",{style:{fontSize:"0.9375rem",color:T?"#ffffff":"#1d1d1f",fontWeight:"500"},children:r.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:"0.8125rem",color:T?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.5)",marginBottom:"0.25rem"},children:"가입일"}),(0,a.jsx)("div",{style:{fontSize:"0.9375rem",color:T?"#ffffff":"#1d1d1f",fontWeight:"500"},children:new Date(p.createdAt).toLocaleDateString("ko-KR")})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:"0.8125rem",color:T?"rgba(255, 255, 255, 0.5)":"rgba(0, 0, 0, 0.5)",marginBottom:"0.25rem"},children:"DORI EXP"}),(0,a.jsxs)("div",{style:{fontSize:"0.9375rem",color:T?"#ffffff":"#1d1d1f",fontWeight:"500"},children:[p.doriExp.toLocaleString(),"EXP"]})]})]})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end",marginTop:"2rem",paddingTop:"2rem",borderTop:"1px solid ".concat(T?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)"),position:"sticky",bottom:"1rem",background:T?"rgba(0, 0, 0, 0.8)":"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(10px)",zIndex:10},children:[(0,a.jsx)("button",{onClick:()=>f.back(),disabled:w,style:{padding:"0.875rem 1.5rem",borderRadius:"0.75rem",background:T?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.05)",border:"1px solid ".concat(T?"rgba(255, 255, 255, 0.2)":"rgba(0, 0, 0, 0.1)"),color:T?"#ffffff":"#1d1d1f",cursor:w?"not-allowed":"pointer",fontSize:"0.9375rem",fontWeight:"600",fontFamily:"inherit",opacity:w?.5:1,transition:"all 0.2s"},onMouseEnter:e=>{w||(e.currentTarget.style.opacity="0.8",e.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:e=>{e.currentTarget.style.opacity=w?"0.5":"1",e.currentTarget.style.transform="translateY(0)"},children:"취소"}),(0,a.jsx)("button",{onClick:I,disabled:w,style:{padding:"0.875rem 1.5rem",borderRadius:"0.75rem",background:T?"linear-gradient(135deg, #60a5fa, #a78bfa)":"linear-gradient(135deg, #2563eb, #7c3aed)",border:"none",color:"#ffffff",cursor:w?"not-allowed":"pointer",fontSize:"0.9375rem",fontWeight:"600",fontFamily:"inherit",opacity:w?.7:1,transition:"all 0.2s",boxShadow:w?"none":"0 4px 12px rgba(37, 99, 235, 0.3)"},onMouseEnter:e=>{w||(e.currentTarget.style.opacity="1",e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 16px rgba(37, 99, 235, 0.4)")},onMouseLeave:e=>{e.currentTarget.style.opacity=w?"0.7":"1",e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=w?"none":"0 4px 12px rgba(37, 99, 235, 0.3)"},children:w?"저장 중...":"저장하기"})]})]})})]}):(0,a.jsxs)("main",{style:{backgroundColor:T?"#000000":"#ffffff",minHeight:"100vh",paddingTop:"70px",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,a.jsx)(s.default,{}),(0,a.jsx)("div",{children:"로딩 중..."})]}):(0,a.jsxs)("main",{style:{backgroundColor:T?"#000000":"#ffffff",minHeight:"100vh",paddingTop:"70px",display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,a.jsx)(s.default,{}),(0,a.jsx)("div",{style:{textAlign:"center"},children:(0,a.jsx)("p",{children:"로그인이 필요합니다."})})]})}}},function(e){e.O(0,[29,648,605,690,955,971,117,744],function(){return e(e.s=3073)}),_N_E=e.O()}]);